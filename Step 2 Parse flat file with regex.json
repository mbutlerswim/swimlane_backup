{
    "modifiedByUser": {
        "$type": "Core.Models.Utilities.UserGroupSelection, Core", 
        "id": "58c07aedb104880f5094ac59", 
        "name": "admin"
    }, 
    "name": "Step 2 Parse flat file with regex", 
    "triggers": [
        {
            "hasRecord": true, 
            "$type": "Core.Models.Integrations.Triggers.RecordSaveTrigger, Core", 
            "initialSaveOnly": true, 
            "type": "recordSave", 
            "conditions": [], 
            "availableMappings": [
                "triggerType", 
                "dateTimeExecuted", 
                "user"
            ]
        }
    ], 
    "$type": "Core.Models.Integrations.Task, Core", 
    "createdDate": "2016-12-09T20:59:44.486Z", 
    "disabled": false, 
    "createdByUser": {
        "$type": "Core.Models.Utilities.UserGroupSelection, Core", 
        "id": "58c07aedb104880f5094ac59", 
        "name": "admin"
    }, 
    "modifiedDate": "2017-09-12T18:04:25.351Z", 
    "outputs": [
        {
            "$type": "Core.Models.Integrations.Outputs.SetFieldValueOutput, Core", 
            "type": "setFieldValue", 
            "mappings": [
                {
                    "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
                    "type": "outputParameter", 
                    "value": "awnez", 
                    "key": "SIEM_Platform", 
                    "addMissing": false
                }, 
                {
                    "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
                    "type": "outputParameter", 
                    "value": "a1ba6", 
                    "key": "SIEMID", 
                    "addMissing": false
                }, 
                {
                    "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
                    "type": "outputParameter", 
                    "value": "a8t51", 
                    "key": "EventID", 
                    "addMissing": false
                }, 
                {
                    "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
                    "type": "outputParameter", 
                    "value": "ah690", 
                    "key": "Customer_ID", 
                    "addMissing": false
                }, 
                {
                    "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
                    "type": "outputParameter", 
                    "value": "aj7sm", 
                    "key": "Event_Time", 
                    "addMissing": false
                }, 
                {
                    "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
                    "type": "outputParameter", 
                    "value": "axot4", 
                    "key": "Log_Source_Name", 
                    "addMissing": false
                }, 
                {
                    "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
                    "type": "outputParameter", 
                    "value": "awaxx", 
                    "key": "LastTime", 
                    "addMissing": false
                }, 
                {
                    "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
                    "type": "outputParameter", 
                    "value": "a0o1n", 
                    "key": "SIEM_Rule_ID", 
                    "addMissing": false
                }, 
                {
                    "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
                    "type": "outputParameter", 
                    "value": "ajzk9", 
                    "key": "SIEM_Rule_Name", 
                    "addMissing": false
                }, 
                {
                    "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
                    "type": "outputParameter", 
                    "value": "avuk4", 
                    "key": "EventCount", 
                    "addMissing": false
                }, 
                {
                    "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
                    "type": "outputParameter", 
                    "value": "a4afj", 
                    "key": "Action_Name", 
                    "addMissing": false
                }, 
                {
                    "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
                    "type": "outputParameter", 
                    "value": "axb5v", 
                    "key": "Category", 
                    "addMissing": false
                }, 
                {
                    "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
                    "type": "outputParameter", 
                    "value": "aqktf", 
                    "key": "Device_Action", 
                    "addMissing": false
                }, 
                {
                    "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
                    "type": "outputParameter", 
                    "value": "a8fns", 
                    "key": "SessionID", 
                    "addMissing": false
                }, 
                {
                    "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
                    "type": "outputParameter", 
                    "value": "az2dq", 
                    "key": "Count", 
                    "addMissing": false
                }, 
                {
                    "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
                    "type": "outputParameter", 
                    "value": "a76se", 
                    "key": "SrcIP", 
                    "addMissing": false
                }, 
                {
                    "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
                    "type": "outputParameter", 
                    "value": "aj1sa", 
                    "key": "SrcMac", 
                    "addMissing": false
                }, 
                {
                    "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
                    "type": "outputParameter", 
                    "value": "aiksm", 
                    "key": "SrcPort", 
                    "addMissing": false
                }, 
                {
                    "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
                    "type": "outputParameter", 
                    "value": "axmqr", 
                    "key": "ASN_GeoIP_Src", 
                    "addMissing": false
                }, 
                {
                    "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
                    "type": "outputParameter", 
                    "value": "a8nha", 
                    "key": "DstIP", 
                    "addMissing": false
                }, 
                {
                    "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
                    "type": "outputParameter", 
                    "value": "ahn4p", 
                    "key": "DstMac", 
                    "addMissing": false
                }, 
                {
                    "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
                    "type": "outputParameter", 
                    "value": "avra6", 
                    "key": "DstPort", 
                    "addMissing": false
                }, 
                {
                    "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
                    "type": "outputParameter", 
                    "value": "a4e6b", 
                    "key": "ASN_GeoIP_Dst", 
                    "addMissing": false
                }, 
                {
                    "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
                    "type": "outputParameter", 
                    "value": "a29dj", 
                    "key": "Severity", 
                    "addMissing": false
                }, 
                {
                    "addMissing": false, 
                    "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
                    "value": "axaed", 
                    "dataFormat": "MM/DD/YYYY HH:mm", 
                    "key": "Event_Time_Date", 
                    "type": "outputParameter"
                }, 
                {
                    "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
                    "type": "outputParameter", 
                    "value": "aewkp", 
                    "key": "Normalize_ID_Name", 
                    "addMissing": false
                }, 
                {
                    "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
                    "type": "outputParameter", 
                    "value": "aygw6", 
                    "key": "Customer_Name", 
                    "addMissing": false
                }, 
                {
                    "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
                    "type": "outputParameter", 
                    "value": "ajs6z", 
                    "key": "ack_by", 
                    "addMissing": false
                }, 
                {
                    "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
                    "type": "outputParameter", 
                    "value": "ay859", 
                    "key": "base_events_generation", 
                    "addMissing": false
                }, 
                {
                    "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
                    "type": "outputParameter", 
                    "value": "ac3tf", 
                    "key": "security_event_generation", 
                    "addMissing": false
                }
            ]
        }
    ], 
    "action": {
        "$type": "Core.Models.Integrations.Actions.Python.PythonAction, Core", 
        "readonly": false, 
        "type": "python", 
        "descriptor": {
            "availableOutputTypes": [
                "insertUpdateRecord", 
                "email", 
                "referentialTask", 
                "saveToFile", 
                "setFieldValue"
            ], 
            "description": "Execute Python scripts", 
            "family": "Scripts", 
            "$type": "Core.Models.Integrations.Actions.AvailableActionDescriptor, Core", 
            "name": "Python", 
            "disabled": false, 
            "readonly": false, 
            "actionType": "python", 
            "inputParameters": {
                "$type": "System.Collections.Generic.Dictionary`2[[System.String, mscorlib],[Core.Models.Integrations.Descriptors.Descriptor, Core]], mscorlib"
            }, 
            "id": "a23g74LXKckc_fDnn", 
            "base64Image": "data:image/png;base64,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"
        }, 
        "script": "##############################################################################################################\n# Application Name: Alarms\n# Integration Name: Step 2 Parse flat file with regex\n# Swimlane Version: 2.14 Patch 3\n# Global Integration: On\n#\n##############################################################################################################\n#\n# Validation Date                Validator                Pass/Fail             Comments\n# ###############                ###################      ##################    ##############################\n# 04/13/17  11:40 CDT\t\t\t Joel Laufer\t\t\t  Pass                  \n#\n#\n##############################################################################################################\n# Modificaitons\n##############################################################################################################\n#\n# Date Time Modified            Reason Modified             Developer\n# ######################        #####################       ############\n# 03/13/17 11:40 central        Added Comments Section      Joel Laufer\n# 03/21/17 13:59 central        Added switch for time       Joel Laufer\n#                               stamps \n#\n# 04/10/17 8:21 central         Added Global Methods        Joel Laufer   \n#                               and sql logging.\n##############################################################################################################\n'''\n##############################################################################################################\n#   Inputs\n##############################################################################################################\n\nVariable                     Type                          Field                    Value\n################             ###############               ###############          ###############################\nmessage                      Record                        Full Message                         \n\n\n##############################################################################################################\n#   Outputs\n##############################################################################################################\n\nParameter                    Type                          Field                        Value\n################             ###############               ###################          ###############################\nurl_parent_record            Output Parameter              Security Event Link\npython_output                Output Parameter              Python Output\n\n\n\n'''\n\n##############################################################################################################\n# Python Coding Starts Here\n##############################################################################################################\n#timeprofile_switchg='Off'\n'''\nimport re\nimport datetime\nimport pyodbc\nimport time\n'''\nimport sys\nimport os\nsys.path.append(os.path.abspath(\"e:/SwimlaneConfigs/\"))\nfrom Global_Int_Var import *\n\nconnect_to_swimlane(sw_context.inputs['apiuser_user'],sw_context.inputs['apiuser_credential'])\n\n\ndef pychar_output():\n  if sw_context.inputs['charm_flag']=='On':    \n    fs_charm=open('e:\\SwimlaneConfigs\\step2_charm.txt','w')\n    fs_charm.write(\"sw_context_inputs={'message':\" + '\"' + sw_context.inputs['message'] + '\",' +'\\n' + \\\n                   \"'alarm_id':'\" + sw_context.inputs['alarm_id'] + \"',\" + '\\n' + \\\n                   \"'full_message':'\" + sw_context.inputs['full_message'] +  \"',\" + '\\n' + \\\n                   \"'apiuser_user':'\" + sw_context.inputs['apiuser_user']  +  \"',\" + '\\n' + \\\n                   \"'charm_flag':'\" + sw_context.inputs['charm_flag']  +  \"',\" + '\\n' + \\\n                   \"'apiuser_credential':'\" + sw_context.inputs['apiuser_credential'] +  \"'}\" + '\\n' )\n    fs_charm.write(\"sw_context_config={'RecordId':'\" + sw_context.config[\"RecordId\"]  +  \"'}\" + '\\n')\n               \n\n    fs_charm.close()\n  else:\n    pass\n\npychar_output()\n\n\n\n\n\n\ndef find_app_id(applicationname):\n     app=App.find(name=applicationname)\n     return(app.id)\n\nglobal alarm_id \nalarm_id=find_app_id('Alarms')    \n\nimport datetime\n\n#format1 = '%m_%d_%Y_%H_%M_%S_'\nformat2='%m/%d/%Y %H:%M:%S'\n#d = datetime.datetime.utcnow()\n#d = datetime.datetime.now()\n#date1=d.strftime(format2)\n#date_display=d.strftime(format2)# + ' UTC'\n\nglobal fs_log\nfs_log=open(Debugging_File_Path + 'Step_2_Error_Log.txt','a')\n\ns = datetime.datetime.now()\ndate_display=s.strftime(format2)# + ' UTC'\n\nu_name = sw_context.user[\"display_name\"]\nalarm_id=sw_context.inputs['alarm_id']\nfull_message=sw_context.inputs['full_message']\n#action_name=sw_context.inputs['action_name']\nprg_name='Step 2 Parse flat file with regex'\nfs=open(Debugging_File_Path + \"step_2_log.txt\",\"w\")\n\n\n\n\n\n\n\n\ntimeprofile_switch=Timing_Profile_Mode\nfs.write('Timing Profile: ' + timeprofile_switch + '\\n')\n#append_to_sql_server=='On'\nrecord_id = sw_context.config['RecordId']\n\n \n#Following method is part of Global Methods\n\n\n\n'''\ndef rest1(customer_name):  \n  try:\n      #fs=open('C:/test/restrict.txt','w')\n      if customer_name=='':\n         customer_name='SL-MSS'\n      fs.write('Customer Name:' + customer_name + '\\n')\n      app_id= \"583f29e49aee7c0c2044c5bb\" #The application that you want to restrict records\n      GROUP_FIELD_NAME = customer_name #sw_context.inputs[\"GROUPFIELDNAME\"] #Group field that holds the group to restrict records\n      ADMIN_GROUP_NAME = \"SL-Admins\" #the admin group that will have access to all records\n      MSS_GROUP_NAME = \"SL-MSS\"\n      record_id = sw_context.config['RecordId']\n      record = Record.find(app_id, record_id)\n      group = next(Group.find(name=GROUP_FIELD_NAME))\n      admin_group = next(Group.find(name=ADMIN_GROUP_NAME))\n      mss_group = next(Group.find(name=MSS_GROUP_NAME))\n\n      #fs.write('group:' + str(GROUP_FIELD_NAME) + '\\tGroupID:' + str(group) + '\\n')\n      record.restrict(group, mss_group, admin_group)\n      #record.save()\n    \n  except Exception as e:\n      fs.write('Error occurred:' + str(e) + '\\n')\n      fs_log=open(r'c:\\test\\Step_2_Error_Log.txt','a')\n      fs_log.write(str(alarm_id) + '\\n' + str(date_display) + ' Error Restricting Record \\n' + str(e) + '\\n')\n      fs_log.close()\n'''      \n    \n\n\ndef format_dt(stg1):\n    if stg1!=\"\":\n        Year1=str(stg1[0:4])\n        Month1=str(stg1[5:7])\n        Day1=str(stg1[8:10])\n        Time1=str(stg1[11:20])\n        frmt_Event_Time= Month1 + \"/\" + Day1 + \"/\" + Year1 + \" \" + Time1\n    else:\n        frmt_Event_Time=str(stg1)\n    return(frmt_Event_Time)\n\ndef format_tm(platform, unfrm_tm):\n  if (platform==\"RSA\") and (unfrm_tm!=\"\" and unfrm_tm is not None and unfrm_tm!=\" \") :\n      try:\n          frm_Last_Time=datetime.datetime.fromtimestamp(float(unfrm_tm)).strftime('%c')\n      except:\n          frm_Last_Time= datetime.datetime.fromtimestamp(float(unfrm_tm)/1000).strftime('%c')\n\n  elif platform==\"McAfee\":\n      org_LastTime = str(unfrm_tm).replace(\"Z\",\":00\").replace(\"T\",\" \").replace(\"-\",\"/\")\n      frm_Last_Time=format_dt(org_LastTime)\n      \n  else:\n          frm_Last_Time=\"\"   \n  return(str(frm_Last_Time))\n\ndef main():\n  try:     \n    if timeprofile_switch=='On':\n        f = open(Custom_Library_Path + \"profile_2_parse_mesasge_with_regex.txt\",\"a+\")\n        #START_TIME = datetime.datetime.now()\n        f.write(\"\\r\\n[{}] START\".format(s))\n    \n\n      \n        \n        \n        \n    ''' \n\n    reg = \"SIEM_Platform:(?P<SIEM_Platform>.*?)\\|SIEMID:(?P<SIEMID>.*?)\\|EventID:(?P<EventID>.*?)\\|Customer_ID:(?P<Customer_ID>.*?)\\|\" \\\n          \"Event_Time:(?P<Event_Time>.*?)\\|Log_Source_Name:(?P<Log_Source_Name>.*?)\\|LastTime:(?P<LastTime>.*?)\\|SIEM_Rule_ID:(?P<SIEM_Rule_ID>.*?)\\|\" \\\n          \"SIEM_Rule_Name:(?P<SIEM_Rule_Name>.*?)\\|EventCount:(?P<EventCount>.*?)\\|Action_Name:(?P<Action_Name>.*?)\\|Category:(?P<Category>.*?)\\|\" \\\n          \"Device_Action:(?P<Device_Action>.*?)\\|SessionID:(?P<SessionID>.*?)\\|Count:(?P<Count>.*?)\\|SrcIP:(?P<SrcIP>.*?)\\|SrcMac:(?P<SrcMac>.*?)\\|\" \\\n          \"SrcPort:(?P<SrcPort>.*?)\\|ASN_GeoIP_Src:(?P<ASN_GeoIP_Src>.*?)\\|DstIP:(?P<DstIP>.*?)\\|DstMac:(?P<DstMac>.*?)\\|DstPort:(?P<DstPort>.*?)\\|\" \\\n          \"ASN_GeoIP_Dst:(?P<ASN_GeoIP_Dst>.*?)\\|Severity:(?P<Severity>.*?)\\|Normalize_ID_Name:(?P<Normalize_ID_Name>.*?)\\|\" \\\n          \"SE_Gen:(?P<SE_Gen>.*?)\\|Base_Event_Ret:(?P<Base_Event_Ret>.*?)\\|\"\n    '''\n    reg = \"SIEM_Platform:(?P<SIEM_Platform>.*?)\\|SIEMID:(?P<SIEMID>.*?)\\|EventID:(?P<EventID>.*?)\\|Customer_ID:(?P<Customer_ID>.*?)\\|\" + \\\n          \"Event_Time:(?P<Event_Time>.*?)\\|Log_Source_Name:(?P<Log_Source_Name>.*?)\\|LastTime:(?P<LastTime>.*?)\\|SIEM_Rule_ID:(?P<SIEM_Rule_ID>.*?)\\|\" + \\\n          \"SIEM_Rule_Name:(?P<SIEM_Rule_Name>.*?)\\|EventCount:(?P<EventCount>.*?)\\|Action_Name:(?P<Action_Name>.*?)\\|Category:(?P<Category>.*?)\\|\" + \\\n          \"Device_Action:(?P<Device_Action>.*?)\\|SessionID:(?P<SessionID>.*?)\\|Count:(?P<Count>.*?)\\|SrcIP:(?P<SrcIP>.*?)\\|SrcMac:(?P<SrcMac>.*?)\\|\"  + \\\n          \"SrcPort:(?P<SrcPort>.*?)\\|ASN_GeoIP_Src:(?P<ASN_GeoIP_Src>.*?)\\|DstIP:(?P<DstIP>.*?)\\|DstMac:(?P<DstMac>.*?)\\|DstPort:(?P<DstPort>.*?)\\|\"  + \\\n          \"ASN_GeoIP_Dst:(?P<ASN_GeoIP_Dst>.*?)\\|Severity:(?P<Severity>.*?)\\|Normalize_ID_Name:(?P<Normalize_ID_Name>.*?)\\|\" + \\\n          \"SE_Gen:(?P<SE_Gen>.*?)\\|Base_Event_Ret:(?P<Base_Event_Ret>.*?)\\|\"\n\n\n    #########################################\n    #  Parse Record for all fields first\n    #########################################\n    error_flag='No'\n    if ('SIEM_Platform' not in sw_context.inputs['message']):\n        message=str(alarm_id) + '\\n' + str(date_display) + '\\n **Error parsing Alarm **SIEM_Platform** does not exist** \\n' \n        fs_log.write(message)\n        error_flag='Yes'\n        \n    if ('SIEMID' not in sw_context.inputs['message']):\n        message=str(alarm_id) + '\\n' + str(date_display) +  '\\n **Error parsing Alarm **SIEMID** does not exist** \\n'  + str(reg) + '\\n'  \n        fs_log.write(message)\n        error_flag='Yes'\n    \n    if ('EventID' not in sw_context.inputs['message']):\n        message=str(alarm_id) + '\\n' + str(date_display) +  '\\n **Error parsing Alarm **EventID** does not exist** \\n'  + str(reg) + '\\n'  \n        fs_log.write(message)\n        error_flag='Yes'    \n\n    if ('Customer_ID' not in sw_context.inputs['message']):\n        message=str(alarm_id) + '\\n' + str(date_display) +  '\\n **Error parsing Alarm **Customer_ID** does not exist** \\n'  + str(reg) + '\\n'  \n        fs_log.write(message)\n        error_flag='Yes'      \n        \n    if ('Event_Time' not in sw_context.inputs['message']):\n        message=str(alarm_id) + '\\n' + str(date_display) +  '\\n **Error parsing Alarm **Event_Time** does not exist** \\n'  + str(reg) + '\\n'  \n        fs_log.write(message)\n        error_flag='Yes'\n\n    if ('SIEMID' not in sw_context.inputs['message']):\n        message=str(alarm_id) + '\\n' + str(date_display) +  '\\n **Error parsing Alarm **SIEMID** does not exist** \\n'  + str(reg) + '\\n'  \n        fs_log.write(message)\n        error_flag='Yes'\n\n    if ('Log_Source_Name' not in sw_context.inputs['message']):\n        message=str(alarm_id) + '\\n' + str(date_display) +  '\\n **Error parsing Alarm **Log_Source_Name** does not exist** \\n'  + str(reg) + '\\n'  \n        fs_log.write(message)\n        error_flag='Yes'\n        \n    if ('LastTime' not in sw_context.inputs['message']):\n        message=str(alarm_id) + '\\n' + str(date_display) +  '\\n **Error parsing Alarm **LastTime** does not exist** \\n'  + str(reg) + '\\n'  \n        fs_log.write(message)\n        error_flag='Yes' \n\n    if ('SIEM_Rule_ID' not in sw_context.inputs['message']):\n        message=str(alarm_id) + '\\n' + str(date_display) +  '\\n **Error parsing Alarm **SIEM_Rule_ID** does not exist** \\n'  + str(reg) + '\\n'  \n        fs_log.write(message)\n        error_flag='Yes'\n        \n        \n    if ('SIEM_Rule_Name' not in sw_context.inputs['message']):\n        message=str(alarm_id) + '\\n' + str(date_display) +  '\\n **Error parsing Alarm **SIEM_Rule_Name** does not exist** \\n'  + str(reg) + '\\n'  \n        fs_log.write(message)\n        error_flag='Yes'\n        \n    if ('EventCount' not in sw_context.inputs['message']):\n        message=str(alarm_id) + '\\n' + str(date_display) +  '\\n **Error parsing Alarm **EventCount** does not exist** \\n'  + str(reg) + '\\n'  \n        fs_log.write(message)\n        error_flag='Yes'\n        \n    if ('Action_Name' not in sw_context.inputs['message']):\n        message=str(alarm_id) + '\\n' + str(date_display) +  '\\n **Error parsing Alarm **Action_Name** does not exist** \\n'  + str(reg) + '\\n'  \n        fs_log.write(message)\n        error_flag='Yes'  \n\n        \n    if ('Category' not in sw_context.inputs['message']):\n        message=str(alarm_id) + '\\n' + str(date_display) +  '\\n **Error parsing Alarm **Category** does not exist** \\n'  + str(reg) + '\\n'  \n        fs_log.write(message)\n        error_flag='Yes'\n        \n    if ('SrcPort' not in sw_context.inputs['message']):\n        message=str(alarm_id) + '\\n' + str(date_display) +  '\\n **Error parsing Alarm **SrcPort** does not exist** \\n'  + str(reg) + '\\n'  \n        fs_log.write(message)\n        error_flag='Yes'\n  \n    if ('ASN_GeoIP_Src' not in sw_context.inputs['message']):\n        message=str(alarm_id) + '\\n' + str(date_display) +  '\\n **Error parsing Alarm **ASN_GeoIP_Src** does not exist** \\n'  + str(reg) + '\\n'  \n        fs_log.write(message)\n        error_flag='Yes'\n\n    if ('DstIP' not in sw_context.inputs['message']):\n        message=str(alarm_id) + '\\n' + str(date_display) +  '\\n **Error parsing Alarm **DstIP** does not exist** \\n'  + str(reg) + '\\n'  \n        fs_log.write(message)\n        error_flag='Yes'\n\n    if ('DstMac' not in sw_context.inputs['message']):\n        message=str(alarm_id) + '\\n' + str(date_display) +  '\\n **Error parsing Alarm **DstMac** does not exist** \\n'  + str(reg) + '\\n'  \n        fs_log.write(message)\n        error_flag='Yes'          \n        \n    if ('DstPort' not in sw_context.inputs['message']):\n        message=str(alarm_id) + '\\n' + str(date_display) +  '\\n **Error parsing Alarm **DstPort** does not exist** \\n'  + str(reg) + '\\n'  \n        fs_log.write(message)\n        error_flag='Yes' \n  \n    if ('ASN_GeoIP_Dst' not in sw_context.inputs['message']):\n        message=str(alarm_id) + '\\n' + str(date_display) +  '\\n **Error parsing Alarm **ASN_GeoIP_Dst** does not exist** \\n'  + str(reg) + '\\n'  \n        fs_log.write(message)\n        error_flag='Yes'\n\n    if ('Severity' not in sw_context.inputs['message']):\n        message=str(alarm_id) + '\\n' + str(date_display) +  '\\n **Error parsing Alarm **Severity** does not exist** \\n'  + str(reg) + '\\n'  \n        fs_log.write(message)\n        error_flag='Yes'\n        \n    if ('Normalize_ID_Name' not in sw_context.inputs['message']):\n        message=str(alarm_id) + '\\n' + str(date_display) +  '\\n **Error parsing Alarm **Normalize_ID_Name** does not exist** \\n'  + str(reg) + '\\n'  \n        fs_log.write(message)\n        error_flag='Yes'\n        \n    if ('SE_Gen' not in sw_context.inputs['message']):\n        message=str(alarm_id) + '\\n' + str(date_display) +  '\\n **Error parsing Alarm **SE_Gen** does not exist** \\n'  + str(reg) + '\\n'  \n        fs_log.write(message)\n        error_flag='Yes'\n        \n    if ('Base_Event_Ret' not in sw_context.inputs['message']):\n        message=str(alarm_id) + '\\n' + str(date_display) +  '\\n **Error parsing Alarm **Base_Event_Ret** does not exist** \\n'  + str(reg) + '\\n'  \n        fs_log.write(message)\n        error_flag='Yes' \n            \n    if error_flag=='Yes':\n        raise Exception(message)\n          \n    #fs.write(str(reg) + '\\n')\n\n    match = re.search(reg, sw_context.inputs['message'])\n\n    SIEM_Platform = str(match.group('SIEM_Platform'))\n\n\n    #fs.write('SIEM_Platform:' + str(SIEM_Platform) + '\\n')\n\n    SIEMID = str(match.group('SIEMID'))\n\n    EventID = str(match.group('EventID'))\n    Customer_ID = str(match.group('Customer_ID'))\n\n    ############################################\n    #Event_Time = str(match.group('Event_Time'))\n    #Format Date/Time to MM/DD/YYYY\n    ############################################\n\n    org_Event_Time = str(match.group('Event_Time')).replace(\"Z\",\":00\").replace(\"T\",\" \").replace(\"-\",\"/\")\n    Event_Time= format_dt(org_Event_Time)\n    #Event_Time=str(match.group('Event_Time'))\n\n    # LastTime is in different formats for each platform\n    #   RSA has a numeric datetime stamp XXXXXXXXX, while McAfee has YYYY/MM/DD\n    #   This will be handled by the function call - by passing the platform to the function\n    ########################################################################################\n\n    org_LastTime=str(match.group('LastTime'))\n    if (SIEM_Platform!='' and org_LastTime!=''):\n        LastTime = format_tm(SIEM_Platform, org_LastTime) \n    else:\n        LastTime=''\n\n    Log_Source_Name = str(match.group('Log_Source_Name'))\n    SIEM_Rule_ID = str(match.group('SIEM_Rule_ID'))\n    SIEM_Rule_Name = str(match.group('SIEM_Rule_Name'))\n    EventCount = str(match.group('EventCount'))\n    Action_Name = str(match.group('Action_Name'))\n    Category = str(match.group('Category'))\n    Device_Action = str(match.group('Device_Action'))\n    SessionID = str(match.group('SessionID'))\n    Count = str(match.group('Count'))\n    SrcIP = str(match.group('SrcIP'))\n    SrcMac = str(match.group('SrcMac'))\n    SrcPort = str(match.group('SrcPort'))\n    ASN_GeoIP_Src = str(match.group('ASN_GeoIP_Src'))\n    DstIP = str(match.group('DstIP'))\n    DstMac = str(match.group('DstMac'))\n    DstPort = str(match.group('DstPort'))\n    ASN_GeoIP_Dst = str(match.group('ASN_GeoIP_Dst'))\n    Severity = str(match.group('Severity'))\n    Normalize_ID_Name  = str(match.group('Normalize_ID_Name'))\n    SE_Gen=str(match.group('SE_Gen'))\n    Base_Event_Ret=str(match.group('Base_Event_Ret'))\n\n    if (SE_Gen==True or SE_Gen=='True'):\n        SE_Gen='True'\n    else:\n        SE_Gen='False'\n\n    if (Base_Event_Ret==True or Base_Event_Ret=='True'):\n        Base_Event_Ret='True'\n    else:\n        Base_Event_Ret='False'\n                   \n                   \n    customer_name=next((item['customer_name'] for item in customer if item.get(\"customer_id\") == Customer_ID), \"Customer ID not found in translation file\")\n\n    \n    #restrictrec(customer_name,'583f29e49aee7c0c2044c5bb',record_id,fs_log)  \n    restrictrec(customer_name,alarm_id,record_id,fs_log) \n    sw_outputs.append({\"SIEM_Platform\":SIEM_Platform, \"SIEMID\":SIEMID, \"EventID\":EventID, \"Customer_ID\":Customer_ID, \"Event_Time\":Event_Time, \"Log_Source_Name\":Log_Source_Name, \"LastTime\":LastTime, \"SIEM_Rule_ID\":SIEM_Rule_ID, \"SIEM_Rule_Name\":SIEM_Rule_Name, \"EventCount\":EventCount, \"Action_Name\":Action_Name, \"Category\":Category, \"Device_Action\":Device_Action, \"SessionID\":SessionID, \"Count\":Count, \"SrcIP\":SrcIP, \"SrcMac\":SrcMac, \"SrcPort\":SrcPort, \"ASN_GeoIP_Src\":ASN_GeoIP_Src, \"DstIP\":DstIP, \"DstMac\":DstMac, \"DstPort\":DstPort, \"ASN_GeoIP_Dst\":ASN_GeoIP_Dst, \"Severity\":Severity,\"Event_Time_Date\":Event_Time[:16],\"Normalize_ID_Name\":Normalize_ID_Name,\"Customer_Name\":customer_name,\"Base_Event_Ret\":Base_Event_Ret,\"SE_Gen\":SE_Gen,\"ack_by\":u_name,\"base_events_generation\":Base_Event_Ret,\"security_event_generation\":SE_Gen})\n\n    if timeprofile_switch=='On': \n        #f.write(\"\\r\\n[{}] \" + Action_Name.strip(\" \") + \" DONE. Total time = {}\".format(datetime.datetime.now(), (datetime.datetime.now()-START_TIME)))\n        f.write(\"\\r\\n[{}] {}                 DONE.                  TOTAL_TIME=[{}]\".format(datetime.datetime.now(), Action_Name ,(datetime.datetime.now() - s)))\n        f.close()\n    fs.write('SIEM_Rule_Name' + SIEM_Rule_Name + '\\n')\n\n\n    try:\n\n        customer_name=next((item['customer_name'] for item in customer if item.get(\"customer_id\") == Customer_ID), \"Customer ID not found in translation file\")\n        ln_nbr='153'\n        function_name='Main' \n        TOTAL_TIME=(datetime.datetime.now()-s)\n        fs.write(prg_name + ' ' + alarm_id + ' ' + Action_Name + '\\n')\n        fs.write('Total Time: ' + \"{}\".format(TOTAL_TIME) + '\\n')\n        #Create_Error_Log_Entry(prg_name,'1152',function_name,'N','',str(TOTAL_TIME).split('.')[0],alarm_id,full_message,Action_Name,fs,customer_name)   \n        Create_Error_Log_Entry(prg_name,'1152',function_name,'N','',str(TOTAL_TIME),alarm_id,full_message,Action_Name,fs,customer_name,'',str(SIEM_Rule_Name),'')\n        fs.close()\n    except Exception as e:\n        #fs_log=open(r'c:\\test\\Step_2_Error_Log.txt','a')\n        fs_log.write(str(alarm_id) + '\\n' + str(date_display) + ' Error writing to SQL Server \\n' + str(e) + '\\n')\n        fs_log.close()\n        #rest(customer_name)\n        fs.close()\n        pass\n      \n  except Exception as e:\n        #fs_log=open(r'c:\\test\\Step_2_Error_Log.txt','a')\n        #restrictrec('','583f29e49aee7c0c2044c5bb',record_id,fs_log)\n        restrictrec('',alarm_id,record_id,fs_log)\n        fs_log.write(str(alarm_id) + '\\n' + str(date_display) + '\\n' + str(reg) + '\\n **Error parsing Alarm** \\n' + str(e) + '\\n' + str(sw_context.inputs['message'])+'\\n\\n')\n        raise Exception (str(alarm_id) + '\\n' + str(date_display) + '\\n' + str(reg) + '\\n **Error parsing Alarm** \\n' + str(e) + '\\n' + str(sw_context.inputs['message'])+'\\n\\n')\n        pass\n        \nif __name__ == \"__main__\":\n    main()\n    fs_log.close()\n  \n  \n  \n###########\n#DEBUGGING\n###########\n'''\ntry:\n    import datetime\n    import os\n    st = datetime.datetime.utcnow()\n    fs=open(\"c:/test/flat_file.txt\",\"a\")\n\n    if SIEM_Platform==\"RSA\":\n        org_dt=Event_Time\n        Year1=str(org_dt[0:4])\n        Month1=str(org_dt[5:7])\n        Day1=str(org_dt[8:10])\n        Time1=str(org_dt[11:20])\n        fs.write(\"Orig Event Time: \" + str(Event_Time) + \"\\n\")\n        fs.write(\"RSA \" + Month1 + \"/\" + Day1 + \"/\" + Year1 + \" \" + Time1 + \"\\n\")  \n        \n        #fs.write(\"Orig:\" + str(match.group('Event_Time')) + \" Modified:\" + LastTime + \"\\n\")\n        \n        #fs.write(\"\\n\\n******************\\n\" + str(st) + \"\\n\" + \"SIEM_Platform\" + SIEM_Platform +  \"\\n\" + \"SIEMID:\" + SIEMID + \"\\n\" + \"EventID:\" + EventID + \"\\n\" +  \"Customer_ID:\" + Customer_ID + \"\\n\" +  \"Event_Time:\" + Event_Time + \"\\n\" +  \"Log_Source_Name:\" + Log_Source_Name + \"\\n\" +  \"LastTime:\" + LastTime + \"\\n\" +  \"SIEM_Rule_ID:\" + SIEM_Rule_ID + \"\\n\" +  \"SIEM_Rule_Name:\" + SIEM_Rule_Name + \"\\n\" +  \"EventCount:\" + EventCount + \"\\n\" +  \"Action_Name:\" + Action_Name + \"\\n\" +  \"Category:\" + Category + \"\\n\" +  \"Device_Action:\" + Device_Action + \"\\n\" +  \"SessionID:\" + SessionID + \"\\n\" +  \"Count:\" + Count + \"\\n\" +  \"SrcIP:\" + SrcIP + \"\\n\" +  \"SrcMac:\" + SrcMac + \"\\n\" +  \"SrcPort:\" + SrcPort + \"\\n\" +  \"ASN_GeoIP_Src:\" + ASN_GeoIP_Src + \"\\n\" +  \"DstIP:\" + DstIP + \"\\n\" +  \"DstMac:\" + DstMac + \"\\n\" +  \"DstPort:\" + DstPort + \"\\n\" +  \"ASN_GeoIP_Dst:\" + ASN_GeoIP_Dst + \"\\n\" +  \"Severity:\" + Severity + \"\\n\\n\")\n    else:\n        org_dt=Event_Time\n        Year1=str(org_dt[0:4])\n        Month1=str(org_dt[5:7])\n        Day1=str(org_dt[8:10])\n        Time1=str(org_dt[11:20])\n        fs.write(\"Orig Event Time: \" + str(Event_Time) + \"\\n\")\n        fs.write(\"McAfee \" + Month1 + \"/\" + Day1 + \"/\" + Year1 + \" \" + Time1 + \"\\n\")           \n    \n    fs.close\nexcept Exception as e:\n    st = datetime.datetime.utcnow()\n    fs.write( str(st) +  \"\\n Following Error occured:\" + str(e) + \"\\n\" ) \n    fs.close\n    pass\n'''    "
    }, 
    "inputMapping": [
        {
            "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
            "type": "record", 
            "value": "azeb0", 
            "key": "message", 
            "addMissing": false
        }, 
        {
            "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
            "type": "record", 
            "value": "583f29e49aee7c0c2044c5bd", 
            "key": "alarm_id", 
            "addMissing": false
        }, 
        {
            "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
            "type": "record", 
            "value": "azeb0", 
            "key": "full_message", 
            "addMissing": false
        }, 
        {
            "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
            "type": "credentials", 
            "value": "apiuser_user", 
            "key": "apiuser_user", 
            "addMissing": false
        }, 
        {
            "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
            "type": "credentials", 
            "value": "apiuser_credential", 
            "key": "apiuser_credential", 
            "addMissing": false
        }, 
        {
            "$type": "Core.Models.Integrations.Descriptors.Mapping, Core", 
            "type": "literal", 
            "value": "Off", 
            "key": "charm_flag", 
            "addMissing": false
        }
    ], 
    "applicationId": "aYvGaX9lTbPM4", 
    "id": "a4WNMoQnIvEra"
}